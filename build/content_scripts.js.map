{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/content_scripts.js","webpack:///./src/helpers.js","webpack:///./src/index.js"],"names":["listItemTmp","item","cookie_name","ch_id_name","channelId","topPlVideos","clearVideoCount","doneVideoCount","templates","IDS","MESSAGES","TEASERS","checkUser","loadOn","chrome","runtime","sendMessage","action","response","getChannelId","getTemplates","parser","DOMParser","doc","parseFromString","elArr","Array","prototype","slice","call","getElementsByTagName","sText","filter","el","textContent","indexOf","split","JSON","parse","serviceParams","responseContext","serviceTrackingParams","forEach","service","ytId","params","value","getChannelTitle","checkAuthState","Error","e","console","log","exec","$","find","attr","id","title","text","html","scripts","tagText","alert","loadOff","auth_token","setCookie","getTopPlVideos","checkChannelId","getNewVideos","get","then","payload","promiseArr","data","videos","length","video","playlistVideoRenderer","videoId","checkVideoCard","Promise","all","results","ytData","contents","twoColumnBrowseResultsRenderer","tabs","tabRenderer","content","sectionListRenderer","itemSectionRenderer","playlistVideoListRenderer","lengthSeconds","videoPromise","resolve","reject","v","feature_templates","key","removeClass","push","setCard","videoData","clearResolve","setResolve","type","start_ms","show_warnings","video_item_id","video_url","custom_message","teaser_text","session_token","getCookie","lengthStep","Math","round","links","messages","teasers","each","idx","setCardRequest","cardVideoId","substr","action_create_video","channel_url","action_create_collaborator","addClass","lastError","localStorageSetItem","error","message","setTimeout","reduce","previousPromise","clearCard","options","set","mainResolve","video_id","cards","localStorage","getItem","setItem","now","Date","time","getTime","expireTime","setTime","document","cookie","toGMTString","localStorageGetItem","append","on","preventDefault","has_card","currentTarget","dataset","btn","toggleClass","hasClass","closest","show","showPopup","hidePopup","hide","name","matches","match","RegExp","replace","decodeURIComponent","undefined","oldArray","newArray","unique","concat","stringify","arr","i","len","out","obj","page","URL"],"mappings":"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","file":"content_scripts.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import { loadOn } from \"./helpers\";\nimport { loadOff } from \"./helpers\";\nimport { getCookie } from \"./helpers\";\nimport { localStorageSetItem } from \"./helpers\";\nimport { localStorageGetItem } from \"./helpers\";\nimport { showPopup } from \"./helpers\";\nimport { hidePopup } from \"./helpers\";\n\nfunction listItemTmp (item) {\n  return `<div class=\"js-list-item\">${item}</div>`;\n}\n\nexport default function() {\n  const cookie_name = \"tools_auth_token_\";\n  const ch_id_name = \"tools_channel_id\";\n  let channelId = \"\";\n  let topPlVideos = [];\n  let clearVideoCount = 0;\n  let doneVideoCount = 0;\n  const templates = {\n    IDS: [],\n    MESSAGES: [],\n    TEASERS: []\n  }\n\n  checkUser();\n\n  function checkUser() {\n\n    loadOn();\n\n    chrome.runtime.sendMessage({ action: \"get_id\" }, response => {\n      getChannelId(response);\n    });\n\n    getTemplates();\n  }\n\n  function getChannelId(response) {\n    var parser = new DOMParser();\n    var doc = parser.parseFromString(response, \"text/html\");\n    var elArr = Array.prototype.slice.call(doc.getElementsByTagName(\"script\"));\n    var sText = elArr.filter(function(el) {\n      return el.textContent.indexOf(\"GUIDED_HELP\") > -1;\n    });\n\n    try {\n\t\t\tsText = sText[0].textContent.split('var ytInitialGuideData = JSON.parse(')[1].split(');')[0];\n\t\t\tsText = JSON.parse(sText);\n\t\t\tsText = JSON.parse(sText);\n\n\t\t\tvar serviceParams = sText.responseContext.serviceTrackingParams;\n\n\t\t\tserviceParams.forEach(function(item) {\n\t\t\t\tif (item.service === 'GUIDED_HELP') {\n\t\t\t\t\tytId = item.params[0].value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (ytId) {\n\t\t\t\tgetChannelTitle(channelId);\n\n\t\t\t\tcheckAuthState(elArr,channelId);\n\n\t\t\t\treturn;\n\t\t\t} else{\n\t\t\t\tthrow new Error('no channel ID');\n\t\t\t}\n\n\t\t} catch(e) {\n\t\t\tconsole.log(e)\n    }\n    \n    sText = elArr.filter(function(el){return el.textContent.indexOf(\"GUIDED_HELP\") > -1;});\n\n\n    if (sText[0].textContent.indexOf('creator_channel_id\",\"value\":\"') > -1) {\n      channelId = /creator_channel_id\",\"value\":\"([^\"]+)\"/.exec(\n        sText[0].textContent\n      )[1];\n    } else {\n      channelId = $(doc).find('.spf-link[title=\"Мой канал\"]').attr('href') || $(doc).find('.spf-link[title=\"My channel\"]').attr('href');\n\t\t\tchannelId = channelId.split('/channel/')[1];\n      // sText = elArr.filter(function(el) {\n      //   return el.textContent.indexOf(\"GAPI_HINT_PARAMS\") > -1;\n      // });\n      // channelId = /creator_channel_id\":\"([^\"]+)\"/.exec(sText[0].textContent)[1];\n    }\n\n    getChannelTitle(channelId);\n\n    checkAuthState(elArr, channelId);\n  }\n\n  function getChannelTitle(channelId) {\n    chrome.runtime.sendMessage(\n      { action: \"get_title\", id: channelId },\n      response => {\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(response, \"text/html\");\n        var title = \"\";\n\n        if (doc.getElementsByTagName(\"title\")[1]) {\n          title = doc.getElementsByTagName(\"title\")[1].text;\n        } else {\n          title = doc.getElementsByTagName(\"title\")[0].text;\n        }\n\n        $(\".channel-title\").html(title);\n      }\n    );\n  }\n\n  function checkAuthState(scripts, channelId) {\n    var tagText = scripts.filter(function(el) {\n      return el.textContent.indexOf(\"GAPI_HINT_PARAMS\") > -1;\n    });\n\n    if (typeof tagText[0] === \"undefined\") {\n      alert(\"Auth token error!\");\n      loadOff();\n      return false;\n    }\n\n    var auth_token = \"\";\n    if (tagText[0].textContent.indexOf('\"XSRF_TOKEN\"') > -1) {\n      auth_token = /XSRF_TOKEN\":\"([^\"]+)\"/.exec(tagText[0].textContent)[1];\n    } else {\n      tagText = scripts.filter(function(el) {\n        return el.textContent.indexOf(\"GOOGLE_HELP_CONTEXT\") > -1;\n      });\n      auth_token = /XSRF_TOKEN': \"([^\"]+)\"/.exec(tagText[0].textContent)[1];\n    }\n\n    setCookie(channelId, auth_token);\n\n    getTopPlVideos();\n\n    checkChannelId(channelId);\n  }\n\n  function getNewVideos() {\n    $.get('/admin/cards?channel_id=' + channelId).then(function(payload) {\n      const promiseArr = [];\n\n      clearVideoCount += payload.data.videos.length;\n\n      payload.data.videos.forEach(item => {\n        let video = {\n          playlistVideoRenderer: {\n            videoId: item\n          }\n        };\n\n        checkVideoCard(item, video, promiseArr);         \n      });\n\n      Promise.all(promiseArr).then((results)=>{\n        loadOff();\n      });\n    });\n  }\n\n  function getTopPlVideos() {\n    chrome.runtime.sendMessage(\n      { action: \"get_pl_videos\", id: channelId },\n      response => {\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(response, \"text/html\");\n        var elArr = Array.prototype.slice.call(\n          doc.getElementsByTagName(\"script\")\n        );\n        var sText = elArr.filter(function(el) {\n          return el.textContent.indexOf(\"responseContext\") > -1;\n        });\n\n        var ytData = sText[0].textContent\n          .split('window[\"ytInitialData\"] = ')[1]\n          .split(\";\");\n        topPlVideos = JSON.parse(ytData[0]).contents\n          .twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content\n          .sectionListRenderer.contents[0].itemSectionRenderer.contents[0]\n          .playlistVideoListRenderer.contents;\n\n        clearVideoCount = topPlVideos.length;\n\n        const promiseArr = [];\n\n        topPlVideos.forEach(item => {\n          let video = item.playlistVideoRenderer;\n\n          if (video.lengthSeconds) {\n            checkVideoCard(video.videoId, item, promiseArr);         \n          } else{\n            clearVideoCount--;\n          }\n        });\n\n        Promise.all(promiseArr).then((results)=>{\n          getNewVideos();\n        });\n      }\n    );\n  }\n\n  function checkVideoCard(videoId, item, promiseArr) {\n    let videoPromise = new Promise((resolve, reject) =>{\n      chrome.runtime.sendMessage(\n        { action: \"check_card\", v: videoId },\n        response => {\n          item[\"cards\"] = [];\n\n          if (\n            response.feature_templates.length &&\n            response.feature_templates[0].key\n          ) {\n            item[\"has_card\"] = true;\n            item[\"cards\"] = response.feature_templates;\n            doneVideoCount++;\n            clearVideoCount--;\n          }\n\n\n          $(\".js-videos-count\").removeClass(\"hide\");\n          $(\".js-all-count\").text(clearVideoCount);\n          $(\".js-done-count\").text(doneVideoCount);\n\n          resolve(item);\n        }\n      );\n    });\n\n    promiseArr.push(videoPromise);\n  }\n\n  function setCard(videoData, video, clearResolve) {\n    return new Promise(setResolve => {\n      let params = {\n        key: \"\",\n        type: \"video\",\n        start_ms: 30000,\n        show_warnings: true,\n        video_item_id: \"\",\n        video_url: \"\",\n        custom_message: \"\",\n        teaser_text: \"\",\n        session_token: getCookie(cookie_name + channelId)\n      };\n\n      let lengthStep = 120 * 1000;\n\n      if (videoData.lengthSeconds < 600) {\n        lengthStep = Math.round((videoData.lengthSeconds / 6) * 1000);\n        params.start_ms = lengthStep;\n      }\n\n      const links = [];\n      const messages = [];\n      const teasers = [];\n\n      $(\".video_item_id\").each((idx, item) => {\n        if (item.value) {\n          links.push(item.value);\n        }\n      });\n\n      $(\".custom_message\").each((idx, item) => {\n        messages.push(item.value ? item.value : '');\n      });\n      \n      $(\".teaser_text\").each((idx, item) => {\n        teasers.push(item.value ? item.value : '');\n      });\n\n      const setCardRequest = (cardVideoId, idx) => {\n        if (cardVideoId.substr(0,2) === 'UC') {\n          delete params.action_create_video;\n          params['action_create_collaborator'] = 1;\n          params['channel_url'] = cardVideoId;\n          params['type'] = 'collaborator';\n        }else {\n          delete params.channel_url;\n          delete params.action_create_collaborator;\n          params['action_create_video'] = 1;\n          params['type'] = 'video';\n        }\n        \n        params.video_item_id = cardVideoId;\n        params.custom_message = messages[idx];\n        params.teaser_text = teasers[idx];\n\n        if (idx > 0) {\n          params.start_ms += lengthStep;\n        }\n\n        $('.cat-loader').addClass('_show');\n\n        return new Promise((resolve, reject) => {\n          chrome.runtime.sendMessage(\n            { action: \"set_card\", v: videoData.videoId, params: params },\n            (response) => {\n              const lastError = chrome.runtime.lastError;\n\n              localStorageSetItem('IDS', params.video_item_id);\n              localStorageSetItem('MESSAGES', params.custom_message);\n              localStorageSetItem('TEASERS', params.teaser_text);\n\n              resolve();\n\n              if (lastError || response.error) {\n                console.log(lastError.message);\n                // 'Could not establish connection. Receiving end does not exist.'\n                reject();\n                \n                return;\n              }\n\n              if (idx === links.length - 1) {\n                let templates = response\n                  .split('response\">')[1]\n                  .split(\"</textarea>\")[0];\n\n                video[\"cards\"] = JSON.parse(templates).feature_templates;\n                clearVideoCount--;\n                doneVideoCount++;\n                video[\"has_card\"] = true;\n\n                $(\".js-all-count\").text(clearVideoCount);\n                $(\".js-done-count\").text(doneVideoCount);\n\n                getTemplates();\n                \n                setTimeout(() => {\n                  $('.cat-loader').removeClass('_show');\n\n                  clearResolve ? clearResolve() : setResolve();\n                },1000);\n              }\n            }\n          );\n        });\n      };\n\n      links.reduce((previousPromise, cardVideoId, idx) => {\n        return previousPromise.then(() => {\n          return setCardRequest(cardVideoId, idx);\n        });\n      }, Promise.resolve());\n    });\n  }\n\n  function clearCard(options) {\n    const {videoData, video, set} = options;\n    return new Promise(mainResolve => {\n      const setCardRequest = (item, idx) => {\n        let params = {\n          key: item.key,\n          type: item.type,\n          start_ms: item.start_ms,\n          show_warnings: true,\n          video_item_id: item.video_id,\n          video_url: \"\",\n          channel_url: item.channel_url,\n          custom_message: item.custom_message,\n          teaser_text: item.teaser_text,\n          session_token: getCookie(cookie_name + channelId)\n        };\n\n        return new Promise(resolve => {\n          $('.cat-loader').addClass('_show');\n\n          chrome.runtime.sendMessage(\n            { action: \"clear_card\", v: videoData.videoId, params: params },\n            () => {\n              resolve();\n\n              if (idx === video.cards.length - 1) {\n                delete video[\"has_card\"];\n\n                clearVideoCount++;\n                doneVideoCount--;\n\n                $(\".js-all-count\").text(clearVideoCount);\n                $(\".js-done-count\").text(doneVideoCount);\n\n                $('.cat-loader').removeClass('_show');\n                \n                set ? setCard(videoData, video, mainResolve) : mainResolve();\n              }\n            }\n          );\n        });\n      };\n\n      video.cards.reduce((previousPromise, item, idx) => {\n        return previousPromise.then(() => {\n          return setCardRequest(item, idx);\n        });\n      }, Promise.resolve());\n    });\n  }\n\n  function checkChannelId(channelId) {\n    if (localStorage.getItem(ch_id_name) != channelId) {\n      localStorage.setItem(ch_id_name, channelId);\n    } else {\n      localStorage.setItem(ch_id_name, channelId);\n    }\n  }\n\n  function setCookie(channelId, auth_token) {\n    var now = new Date();\n    var time = now.getTime();\n    var expireTime = time + 1000 * 3300;\n    now.setTime(expireTime);\n    document.cookie =\n      cookie_name +\n      channelId +\n      \"=\" +\n      auth_token +\n      \"; path=/; expires=\" +\n      now.toGMTString();\n  }\n\n  function getTemplates() {\n    templates.IDS = localStorageGetItem('IDS') || [];\n    templates.MESSAGES = localStorageGetItem('MESSAGES') || [];\n    templates.TEASERS = localStorageGetItem('TEASERS') || [];\n\n    $('.list-content').html('');\n\n    templates.IDS.forEach((item) => {\n      $('.ids-list').append(listItemTmp(item));\n    });\n\n    templates.MESSAGES.forEach((item) => {\n      $('.messages-list').append(listItemTmp(item));\n    });\n\n    templates.TEASERS.forEach((item) => {\n      $('.teasers-list').append(listItemTmp(item));\n    });\n  }\n\n  // SET CARDS\n  $(\".js-set-card-btn\").on(\"click\", e => {\n    e.preventDefault();\n\n    const links = [];\n\n    $(\".video_item_id\").each((idx, item) => {\n      if (item.value) {\n        links.push(item.value);\n      }\n    });\n\n    if (!links.length) return;\n\n    topPlVideos.reduce((previousPromise, item) => {\n      return previousPromise.then(() => {\n        if (item.has_card) {\n          return clearCard({videoData: item.playlistVideoRenderer, video: item, set: true});\n        }\n\n        return setCard(item.playlistVideoRenderer, item);\n      });\n    }, Promise.resolve());\n  });\n\n  // CLEAR CARDS\n  $(\".js-clear-card-btn\").on(\"click\", e => {\n    e.preventDefault();\n\n    topPlVideos.reduce((previousPromise, item) => {\n      if (!item.has_card) {\n        return Promise.resolve();\n      }\n\n      return previousPromise.then(() => {\n        return clearCard({videoData: item.playlistVideoRenderer, video: item, set: false});\n      });\n    }, Promise.resolve());\n  });\n\n\n  $('.list-ico').on('click', (e) => {\n    const type = e.currentTarget.dataset.type;\n    const btn = $(e.currentTarget);\n\n    \n    btn.toggleClass('open');\n    \n    if (templates[type].length) {\n      if (btn.hasClass('open')) {\n        $('.list-block').closest('div').removeClass('focus');\n        btn.closest('div').addClass('focus');\n      }else {\n        $('.list-ico').removeClass('open');\n        btn.closest('div').removeClass('focus');\n      }\n      // $(e.currentTarget).closest('div').toggleClass('focus');\n    }\n  });\n}\n","export function loadOn() {\n  $(\".b-loader\").show();\n}\n\nexport function showPopup(text) {\n  $(\".b-popup\").addClass(\"_show\");\n  $(\".b-popup-box\").html(text);\n  setTimeout(() => {\n    hidePopup();\n  }, 1500);\n}\n\nexport function hidePopup() {\n  $(\".b-popup\").removeClass(\"_show\");\n}\n\nexport function loadOff() {\n  $(\".b-loader\").hide();\n}\n\nexport function getCookie(name) {\n  var matches = document.cookie.match(\n    new RegExp(\n      \"(?:^|; )\" +\n        name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, \"\\\\$1\") +\n        \"=([^;]*)\"\n    )\n  );\n  return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nexport function localStorageSetItem(key, value) {\n  if (!value) return;\n  \n  let oldArray = localStorageGetItem(key);\n  \n  if (!oldArray) {\n    oldArray = [];\n  }\n\n  const newArray = unique(oldArray.concat(value));\n\n  localStorage.setItem(key, JSON.stringify(newArray));\n}\n\nexport function localStorageGetItem(key) {\n  return JSON.parse(localStorage.getItem(key));\n}\n\nfunction unique(arr) {\n  var i,\n      len = arr.length,\n      out = [],\n      obj = { };\n  \n  for (i = 0; i < len; i++) {\n      obj[arr[i]] = 0;\n  }\n  for (i in obj) {\n      out.push(i);\n  }\n  return out;\n};","import content from './content_scripts';\n\nconst page = /cards/;\nconst match = page.exec(document.URL);\n\nif(match){\n  content();\n}"],"sourceRoot":""}