{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/cards.js","webpack:///./src/endings.js","webpack:///./src/helpers.js","webpack:///./src/index.js"],"names":["listItemTmp","item","error","listClass","cookie_name","ch_id_name","channelId","videos","topPlVideos","newVideos","mostViewedVideos","ytVideos","cardsTemplates","doneVideoCount","client","version","apiKey","ar","templates","IDS","MESSAGES","TEASERS","COPY_IDS","PL_IDS","checkUser","getYtAr","chrome","runtime","sendMessage","action","response","elArr","getYtScripts","sText","filter","el","textContent","indexOf","exec","loadOn","$","append","getChannelId","getTemplates","parser","DOMParser","doc","parseFromString","split","JSON","parse","serviceParams","responseContext","serviceTrackingParams","forEach","service","params","value","checkAuthState","Error","e","console","log","find","attr","getChannelTitle","id","title","getElementsByTagName","text","html","loadOff","scripts","tagText","alert","auth_token","setCookie","localStorage","setItem","getVideos","page","addClass","promiseArr","elements","time","length","push","splice","video","playlistVideoRenderer","videoId","lengthSeconds","checkVideoCard","Promise","all","then","removeClass","getTopPlVideos","plId","ytData","contents","twoColumnBrowseResultsRenderer","tabs","tabRenderer","content","sectionListRenderer","itemSectionRenderer","playlistVideoListRenderer","findVideo","element","results","localStorageSetItem","videoPromise","resolve","reject","v","feature_templates","key","setCard","allVideos","idx","array","video_item_id","custom_message","teaser_text","css","fillErrors","errors","form_errors","message","er","trim","clearCard","session_token","getCookie","options","Array","prototype","slice","call","copyCards","fillCards","each","video_id","playlist_id","channel_url","val","now","Date","getTime","expireTime","setTime","document","cookie","toGMTString","localStorageGetItem","lists","toLowerCase","refresh","getParams","links","i","messages","teasers","start_ms","videoData","type","show_warnings","video_url","lengthStep","Math","round","action_create_video","action_create_collaborator","on","preventDefault","concat","clearArray","filledArray","filledArrayToClear","cards","k","size","deleteSize","clearSubArray","filledSubArray","ceil","setCardPromise","reduce","previousPromise","subItem","clearCardPromise","currentTarget","dataset","btn","toggleClass","hasClass","closest","callToAction","endings","matchCall","URL","matchEndings","match","itemsObj","itemImg","startState","ytId","token","videoTmpId","itemsArr","prop","removeItem","group","data","description","status","showPopup","documentElement","overlay","innerHTML","image_url","channel_id","getItem","videoObj","j","name","get","resp","slideUp","remove","is_promo","metadata_errors","setTimeout","tmpId","for_editor","body","tollName","listWrap","getElementsByClassName","tokenInp","setAttribute","checkChannelId","trigger","list","newLi","createElement","onclick","appendChild","hidePopup","show","hide","matches","RegExp","replace","decodeURIComponent","undefined","videoSettings","stringify","oldArray","newArray","unique","arr","len","out","obj"],"mappings":"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","file":"content_scripts.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import { loadOn } from \"./helpers\";\nimport { loadOff } from \"./helpers\";\nimport { getCookie } from \"./helpers\";\nimport { localStorageSetItem } from \"./helpers\";\nimport { localStorageGetItem } from \"./helpers\";\n\nfunction listItemTmp (item, error) {\n  let listClass = error ? 'error-list-item' : 'js-list-item';\n\n  return `<div class=\"${listClass}\">${item}</div>`;\n}\n\nexport default function() {\n  const cookie_name = \"tools_auth_token_\";\n  const ch_id_name = \"tools_channel_id\";\n  let channelId = \"\";\n  let videos = [];\n  let topPlVideos = [];\n  let newVideos = [];\n  let mostViewedVideos = [];\n  let ytVideos = [];\n  let cardsTemplates = [];\n  let doneVideoCount = 0;\n\n  const client = {\n    version: '',\n    apiKey: '',\n    ar: ''\n  }\n\n  const templates = {\n    IDS: [],\n    MESSAGES: [],\n    TEASERS: [],\n    COPY_IDS: [],\n    PL_IDS: []\n  }\n\n  checkUser();\n\n  function getYtAr(channelId) {\n    chrome.runtime.sendMessage({ action: \"get_yt_ar\", channelId: channelId }, response => {\n      const elArr = getYtScripts(response);\n      const sText = elArr.filter(function (el) {\n        return el.textContent.indexOf(\"var ytcfg\") > -1;\n      });\n\n      if (sText[0].textContent.indexOf('SERVER_MILLIS_SINCE_EPOCH') > -1) {\n        client.ar = /SERVER_MILLIS_SINCE_EPOCH\":([^\"]+),/.exec(sText[0].textContent)[1];\n      }\n\n    });\n  }\n\n  function checkUser() {\n\n    loadOn();\n\n    $('body').append('<script id=\"initApp\"></script>')\n\n    chrome.runtime.sendMessage({ action: \"get_id\" }, response => {\n      getChannelId(response);\n    });\n\n    getTemplates();\n  }\n\n  function getChannelId(response) {\n    const elArr = getYtScripts(response);\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(response, \"text/html\");\n\n    let sText = elArr.filter(function(el) {\n      return el.textContent.indexOf(\"GUIDED_HELP\") > -1;\n    });\n\n    try {\n\t\t\tsText = sText[0].textContent.split('var ytInitialGuideData = JSON.parse(')[1].split(');')[0];\n\t\t\tsText = JSON.parse(sText);\n\t\t\tsText = JSON.parse(sText);\n\n\t\t\tconst serviceParams = sText.responseContext.serviceTrackingParams;\n\n\t\t\tserviceParams.forEach(function(item) {\n\t\t\t\tif (item.service === 'GUIDED_HELP') {\n\t\t\t\t\tchannelId = item.params[0].value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (channelId) {\n\t\t\t\tcheckAuthState(elArr,channelId);\n\n\t\t\t\treturn;\n\t\t\t} else{\n\t\t\t\tthrow new Error('no channel ID');\n\t\t\t}\n\n\t\t} catch(e) {\n\t\t\tconsole.log(e)\n    }\n    \n    sText = elArr.filter(function(el){return el.textContent.indexOf(\"GUIDED_HELP\") > -1;});\n\n\n    if (sText[0].textContent.indexOf('creator_channel_id\",\"value\":\"') > -1) {\n      channelId = /creator_channel_id\",\"value\":\"([^\"]+)\"/.exec(\n        sText[0].textContent\n      )[1];\n    } else {\n      channelId = $(doc).find('.spf-link[title=\"Мой канал\"]').attr('href') || $(doc).find('.spf-link[title=\"My channel\"]').attr('href');\n\t\t\tchannelId = channelId.split('/channel/')[1];\n    }\n\n    checkAuthState(elArr, channelId);\n  }\n\n  function getChannelTitle(channelId) {\n    chrome.runtime.sendMessage(\n      { action: \"get_title\", id: channelId },\n      response => {\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(response, \"text/html\");\n        var title = \"\";\n\n        if (doc.getElementsByTagName(\"title\")[1]) {\n          title = doc.getElementsByTagName(\"title\")[1].text;\n        } else {\n          title = doc.getElementsByTagName(\"title\")[0].text;\n        }\n\n        $(\".channel-title\").html(title);\n\n        // getVideos(1);\n\n        loadOff();\n      }\n    );\n  }\n\n  function checkAuthState(scripts, channelId) {\n    let tagText = scripts.filter(function(el) {\n      return el.textContent.indexOf(\"GAPI_HINT_PARAMS\") > -1;\n    });\n\n    if (typeof tagText[0] === \"undefined\") {\n      alert(\"Auth token error!\");\n      loadOff();\n      return false;\n    }\n\n    let auth_token = \"\";\n    if (tagText[0].textContent.indexOf('\"XSRF_TOKEN\"') > -1) {\n      auth_token = /XSRF_TOKEN\":\"([^\"]+)\"/.exec(tagText[0].textContent)[1];\n    } else {\n      tagText = scripts.filter(function(el) {\n        return el.textContent.indexOf(\"GOOGLE_HELP_CONTEXT\") > -1;\n      });\n      auth_token = /XSRF_TOKEN': \"([^\"]+)\"/.exec(tagText[0].textContent)[1];\n    }\n\n    setCookie(channelId, auth_token);\n\n    // getVideos();\n\n    getYtAr(channelId);\n\n    getChannelTitle(channelId);\n\n    localStorage.setItem(ch_id_name, channelId);\n  }\n\n  function getVideos(page, params = '') {\n    $('.success-text').addClass('hidden');\n    $('.error-block').addClass('hidden');\n\n    loadOn();\n\n    const promiseArr = [];\n    ytVideos = [];\n\n    chrome.runtime.sendMessage(\n      { action: \"get_new_videos\", page: page, params: params, ar: client.ar },\n      response => {\n        const elArr = getYtScripts(response);\n        const parser = new DOMParser();\n\n        const sText = elArr.filter(function(el) {\n          return el.textContent.indexOf(\"VIDEO_LIST_DISPLAY_OBJECT\") > -1;\n        });\n        \n        let elements = sText[0].textContent.split('VIDEO_LIST_DISPLAY_OBJECT\":')[1].split('}]')[0]+'}]';\n        elements = JSON.parse(elements);\n\n        elements.forEach((item) => {\n          const id = item.id;\n          item = parser.parseFromString(item.html, \"text/html\");\n          const title = $(item).find('.vm-video-title-content').text();\n          let time = $(item).find('.video-time').text().split(':');\n\n          if (!time) return;\n\n          if (time.length > 2) {\n            time = +(time[0]) * 60 * 60 + +(time[1]) * 60 + +(time[2]);\n          }else{\n            time = +(time[0]) * 60 + +(time[1]);\n          }\n\n          videos.push([id, time, title]);\n        });\n\n        elements.length < 25 ? page = 3 : page ++;\n        \n        if (page <= 2) {\n          getVideos(page, params);\n        }\n\n        if (page === 3) {\n          videos = videos.splice(0,50);\n\n          videos.forEach(item => {\n            let video = {\n              playlistVideoRenderer: {\n                videoId: item[0],\n                lengthSeconds: item[1],\n                title: item[2]\n              }\n            };\n    \n            ytVideos.push(video);\n    \n            checkVideoCard(item[0], video, promiseArr);         \n          });\n\n          Promise.all(promiseArr).then(()=>{\n            loadOff();\n\n            if (params) {\n              mostViewedVideos = ytVideos;\n\n              $('.js-most-videos-count').removeClass('hide');\n              $(\".js-most-count\").text(mostViewedVideos.length);\n            }else {\n              newVideos = ytVideos;\n              \n              $('.js-all-videos-count').removeClass('hide');\n              $(\".js-all-count\").text(newVideos.length);\n            }\n          });\n        }\n\n      });\n  }\n\n  function getTopPlVideos(plId) {\n    $('.success-text').addClass('hidden');\n\n    loadOn();\n\n    ytVideos = [];\n\n    chrome.runtime.sendMessage(\n      { action: \"get_pl_videos\", plId: plId },\n      response => {\n        try {\n          const elArr = getYtScripts(response);\n\n          const sText = elArr.filter(function(el) {\n            return el.textContent.indexOf(\"responseContext\") > -1;\n          });\n  \n          const ytData = sText[0].textContent\n            .split('window[\"ytInitialData\"] = ')[1]\n            .split(\"};\");\n          topPlVideos = JSON.parse(ytData[0] + '}').contents\n            .twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content\n            .sectionListRenderer.contents[0].itemSectionRenderer.contents[0]\n            .playlistVideoListRenderer.contents;\n  \n          const promiseArr = [];\n  \n          topPlVideos.forEach(item => {\n            const video = item.playlistVideoRenderer;\n            const findVideo = newVideos.find(function(element) {\n              return element.playlistVideoRenderer.videoId == video.videoId;\n            });\n\n            if (findVideo || !video.lengthSeconds) { return; }\n  \n            ytVideos.push(item);\n          });\n\n          ytVideos.forEach(item => {\n            const video = item.playlistVideoRenderer;\n\n            checkVideoCard(video.videoId, item, promiseArr);   \n          });\n\n          topPlVideos = ytVideos;\n\n          Promise.all(promiseArr).then((results)=>{\n            loadOff();\n  \n            // ytVideos = ytVideos.concat(topPlVideos);\n            \n            $('.js-pl-videos-count').removeClass('hide');\n            $('.js-playlist-count').text(topPlVideos.length);\n  \n            localStorageSetItem('PL_IDS', plId);\n\n            getTemplates();\n          });\n        }catch(e) {\n          loadOff();\n          \n          alert('Wrong Playlist or something else. Please contact Gila.');\n        }\n      }\n    );\n  }\n\n  function checkVideoCard(videoId, item, promiseArr) {\n    let videoPromise = new Promise((resolve, reject) =>{\n      chrome.runtime.sendMessage(\n        { action: \"check_card\", v: videoId },\n        response => {\n          item[\"cards\"] = [];\n\n          if (\n            response.feature_templates &&\n            response.feature_templates.length &&\n            response.feature_templates[0].key\n          ) {\n            item[\"cards\"] = response.feature_templates;\n          }\n\n          $(\".js-videos-count\").removeClass(\"hide\");\n\n          resolve(item);\n        }\n      );\n    });\n\n    promiseArr.push(videoPromise);\n  }\n\n  function setCard(videos, allVideos) {\n    return new Promise((resolve, reject) => {\n\n      videos.forEach((item, idx, array) => {\n        chrome.runtime.sendMessage(\n          { action: \"set_card\", v: item.video.playlistVideoRenderer.videoId, params: item.params },\n          (response) => {\n  \n            localStorageSetItem('IDS', item.params.video_item_id);\n            localStorageSetItem('MESSAGES', item.params.custom_message);\n            localStorageSetItem('TEASERS', item.params.teaser_text);\n\n            doneVideoCount++;\n            \n            $('.progress-bar span').text('Set cards');\n            $('.progress-bar-fill').css('width',100 * (doneVideoCount) / allVideos.length + '%');\n\n            const video = ytVideos.find(function(element) {\n              return element.playlistVideoRenderer.videoId == item.video.playlistVideoRenderer.videoId;\n            });\n  \n            if (response.error) {\n              fillErrors({error: 'Set card error:', video: video});\n\n              reject(response.videoId);\n              \n              return;\n            }\n\n            response = JSON.parse(response\n                .split('response\">')[1]\n                .split(\"</textarea>\")[0]);\n\n            if (response.errors) {\n              let error = '';\n\n              if (response.errors[0] === 'Invalid Request') {\n                error = response.form_errors[0].message;\n              }else{\n                for (let er in response.errors) {\n                  if (response.errors[er].trim().length) {\n                    error = response.errors[er];\n                  }\n                }\n              }\n\n              fillErrors({error: error + ':', video: video});\n            }else{\n              delete video['error'];\n              video[\"cards\"] = response.feature_templates;\n            }\n\n            if (idx === array.length -1) {\n              resolve();\n            }\n          }\n        );\n      });\n    });\n\n  }\n\n  function clearCard(videos, allVideos) {\n    return new Promise((resolve, reject) => {\n      videos.forEach((item, idx, array) => {\n        \n        let params = {\n          key: item.key,\n          session_token: getCookie(cookie_name + channelId)\n        };\n\n        chrome.runtime.sendMessage(\n          { action: \"clear_card\", v: item.id, params: params },\n          (response) => {\n            doneVideoCount++;\n\n            $('.progress-bar span').text('Deleting cards');\n            $('.progress-bar-fill').css('width',100 * (doneVideoCount) / allVideos.length + '%');\n\n            const video = ytVideos.find(function(element) {\n              return element.playlistVideoRenderer.videoId == item.id;\n            });\n\n            if (response.error) {\n              fillErrors({error: 'Can\\'t clear card:', video: video});\n\n              reject(response.videoId);\n              \n              return;\n            }\n\n            video[\"cards\"] = response.feature_templates;\n\n            if (idx === array.length - 1) {\n              resolve();\n            }\n          }\n        );\n      });\n    });\n  }\n\n  function fillErrors(options) {\n    const {video} = options;\n    $('.error-block').removeClass('hidden');\n\n    $('.errors-list').append(listItemTmp(\n        `${options.error} ${video.playlistVideoRenderer.title} (${video.playlistVideoRenderer.videoId})`, \n        'error'\n      )\n    );\n  }\n\n  function getYtScripts(response) {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(response, \"text/html\");\n    const elArr = Array.prototype.slice.call(doc.getElementsByTagName(\"script\"));\n\n    return elArr;\n  }\n\n  function copyCards(videoId) {\n    loadOn();\n\n    chrome.runtime.sendMessage(\n      { action: \"check_card\", v: videoId },\n      (response) => {\n        if (\n          response.feature_templates &&\n          response.feature_templates.length &&\n          response.feature_templates[0].key\n        ) {\n          cardsTemplates = response.feature_templates;\n\n          fillCards();\n\n          localStorageSetItem('COPY_IDS', videoId);\n\n          getTemplates();\n\n        }else{\n          alert('Bad Video Id: ' + videoId);\n        }\n\n        loadOff();\n      });\n  }\n\n  function fillCards() {\n    $('.card-block').each((idx,item) => {\n      if (!cardsTemplates[idx]) return;\n\n      let id = cardsTemplates[idx].video_id || cardsTemplates[idx].playlist_id || cardsTemplates[idx].channel_url;\n      let custom_message = cardsTemplates[idx].custom_message ;\n      let teaser_text = cardsTemplates[idx].teaser_text ;\n      \n      item = $(item);\n\n      item.find('.video_item_id').val(id);\n      item.find('.custom_message').val(custom_message);\n      item.find('.teaser_text').val(teaser_text);\n    });\n  }\n\n  function setCookie(channelId, auth_token) {\n    var now = new Date();\n    var time = now.getTime();\n    var expireTime = time + 1000 * 3300;\n    now.setTime(expireTime);\n    document.cookie =\n      cookie_name +\n      channelId +\n      \"=\" +\n      auth_token +\n      \"; path=/; expires=\" +\n      now.toGMTString();\n  }\n\n  function getTemplates() {\n    templates.IDS = localStorageGetItem('IDS') || [];\n    templates.MESSAGES = localStorageGetItem('MESSAGES') || [];\n    templates.TEASERS = localStorageGetItem('TEASERS') || [];\n    templates.COPY_IDS = localStorageGetItem('COPY_IDS') || [];\n    templates.PL_IDS = localStorageGetItem('PL_IDS') || [];\n\n    $('.list-content').html('');\n\n    const lists = ['IDS', 'MESSAGES', 'TEASERS', 'COPY_IDS', 'PL_IDS'];\n\n    lists.forEach((item) => {\n      templates[item].forEach((value) => {\n        $(`.${item.toLowerCase()}-list`).append(listItemTmp(value));\n      });\n    });\n  }\n\n  function refresh() {\n    videos = [];\n    topPlVideos = [];\n    newVideos = [];\n    mostViewedVideos = [];\n    ytVideos = [];\n\n    $('.b-input-x').val('');\n    $('.js-video-count').addClass('hide');\n    $('.error-block').addClass('hidden');\n    $('.success-text').addClass('hidden');\n    $('.errors-list').html('');\n  }\n\n  function getParams(links, item, i) {\n    const messages = [];\n    const teasers = [];\n    const start_ms = [];\n\n    $(\".custom_message\").each((idx, item) => {\n      messages.push(item.value ? item.value : '');\n    });\n    \n    $(\".teaser_text\").each((idx, item) => {\n      teasers.push(item.value ? item.value : '');\n    });\n\n    $(\".start_ms\").each((idx, item) => {\n      start_ms.push(item.value ? item.value : '');\n    });\n\n    let videoData = item.playlistVideoRenderer;\n\n    let params = {\n      key: \"\",\n      type: \"video\",\n      start_ms: 30000,\n      show_warnings: true,\n      video_item_id: \"\",\n      video_url: \"\",\n      custom_message: \"\",\n      teaser_text: \"\",\n      session_token: getCookie(cookie_name + channelId)\n    };\n\n    let lengthStep = 120 * 1000;\n\n    if (videoData.lengthSeconds < 600) {\n      lengthStep = Math.round((videoData.lengthSeconds / 6) * 1000);\n\n      params.start_ms = lengthStep;\n    }\n\n    if (links[i].indexOf('user') > -1 || links[i].indexOf('channel') > -1) {\n      delete params.action_create_video;\n      params['action_create_collaborator'] = 1;\n      params['channel_url'] = links[i];\n      params['type'] = 'collaborator';\n    }else {\n      delete params.channel_url;\n      delete params.action_create_collaborator;\n      params['action_create_video'] = 1;\n      params['type'] = 'video';\n    }\n    \n    params.video_item_id = links[i];\n    params.custom_message = messages[i];\n    params.teaser_text = teasers[i];\n\n    if (i > 0) {\n      params.start_ms += lengthStep * i;\n    }\n\n    if (start_ms[i]) {\n      let time = start_ms[i].split(':');\n\n      if (time.length > 2) {\n        time = +(time[0]) * 60 * 60 + +(time[1]) * 60 + +(time[2]);\n      }else{\n        time = +(time[0]) * 60 + +(time[1]);\n      }\n\n      params.start_ms = time * 1000;\n    }\n\n    return params;\n  }\n\n  // SET CARDS\n  $(\".js-set-card-btn\").on(\"click\", e => {\n    e.preventDefault();\n\n    const links = [];\n\n    $(\".video_item_id\").each((idx, item) => {\n      if (item.value) {\n        if (item.value.indexOf('/watch?v=') > -1) {\n          item.value = item.value.split('/watch?v=')[1]; \n        }\n\n        links.push(item.value);\n      }\n    });\n\n    if (!links.length || $('.b-input-error').length) return;\n\n    $('.progress-bar').addClass('_show');\n    $('.progress-bar-fill').css('width', 0 + '%');\n\n    $('.success-text').addClass('hidden');\n    $('.error-block').addClass('hidden');\n    $('.errors-list').html('');\n\n    ytVideos = topPlVideos.concat(newVideos).concat(mostViewedVideos);\n\n    \n\n    const clearArray = [];\n    const filledArray = [];\n    const filledArrayToClear = [];\n\n    for (let i = 0; i < links.length; i++) {\n      ytVideos.forEach((item,idx) => {\n        const params = getParams(links, item, i);\n\n        clearArray.push({video: item, params: params});\n      });\n    }\n\n    ytVideos.forEach((item,idx) => {\n      if (item.cards.length) {\n        filledArray.push(item)\n      }\n    });\n    \n    for (let k = 0; k < 5; k++) {\n      filledArray.forEach((item, idx, array) => {\n        if (!item.cards[k]) return;\n\n        filledArrayToClear.push({id: item.playlistVideoRenderer.videoId, key: item.cards[k].key});\n      });\n    }\n\n    const size = 1;\n    const deleteSize = 1;\n    const clearSubArray = [];\n    const filledSubArray = [];\n    \n    for (let i = 0; i <Math.ceil(clearArray.length/size); i++){\n      clearSubArray[i] = clearArray.slice((i*size), (i*size) + size);\n    }\n\n    for (let i = 0; i <Math.ceil(filledArrayToClear.length/deleteSize); i++){\n      filledSubArray[i] = filledArrayToClear.slice((i*deleteSize), (i*deleteSize) + deleteSize);\n    }\n\n    const setCardPromise = () => {\n      doneVideoCount = 0;\n\n      clearSubArray.reduce((previousPromise, subItem, idx, array) => {\n        return previousPromise.then(() => {\n          return setCard(subItem, clearArray).then(() => {\n            if (idx === array.length - 1) {\n              $('.progress-bar').removeClass('_show');\n              $('.success-text').removeClass('hidden');\n\n              getTemplates();\n            }\n          });\n        }).catch((e) => {\n\n          if (idx === array.length - 1) {\n            $('.progress-bar').removeClass('_show');\n            $('.success-text').removeClass('hidden');\n          }\n        });\n      }, Promise.resolve());\n    }\n\n    const clearCardPromise = () => {\n      doneVideoCount = 0;\n\n      filledSubArray.reduce((previousPromise, subItem, idx, array) => {\n        return previousPromise.then(() => {\n          return clearCard(subItem, filledArrayToClear).then(() => {\n            if (idx === array.length - 1) {\n              setCardPromise();\n            }\n          });\n        }).catch((e) => {\n\n          if (idx === array.length - 1) {\n            setCardPromise();\n          }\n        });\n      }, Promise.resolve());\n    }\n\n    if (filledSubArray.length) {\n      clearCardPromise();\n\n      return;\n    }\n\n    setCardPromise();\n  });\n\n  $('.list-ico').on('click', (e) => {\n    const type = e.currentTarget.dataset.type;\n    const btn = $(e.currentTarget);\n\n    \n    btn.toggleClass('open');\n    \n    if (templates[type].length) {\n      if (btn.hasClass('open')) {\n        $('.list-block').closest('div').removeClass('focus');\n        btn.closest('div').addClass('focus');\n      }else {\n        $('.list-ico').removeClass('open');\n        btn.closest('div').removeClass('focus');\n      }\n      // $(e.currentTarget).closest('div').toggleClass('focus');\n    }\n  });\n\n  $('.js-get-last').on('click', () => {\n    videos = [];\n\n    getVideos(1);\n  });\n\n  $('.js-get-list').on('click', () => {\n    var plId = $('.js-pl-id').val();\n    if (!plId) return;\n\n    getTopPlVideos(plId);\n  });\n\n  $('.js-get-most-viewed').on('click', () => {\n    videos = [];\n\n    getVideos(1, '&vmo=viewed&sa=0&sf=viewcount');\n  });\n\n  $('.js-copy-cards').on('click', () => {\n    var videoId = $('.js-video-id').val();\n\n    if (!videoId) return;\n\n    copyCards(videoId);\n  });\n\n  $('.js-refresh-btn').on('click', () => {\n    refresh();\n  });\n}\n","export default function() {\n  var callToAction = /call_to_action/,\n    endings = /annotations/,\n    matchCall = callToAction.exec(document.URL),\n    matchEndings = endings.exec(document.URL),\n    match = matchCall || matchEndings;\n\n\n  var itemsObj = {},\n    itemImg;\n  var startState = true;\n  var ytId;\n\n  if(matchCall){\n\n    $(function(){\n      $('body').on('click','.js-get-tmp-btn',function(){\n        var token = $('.js-auth-token').val();\n        var videoTmpId = $('.js-ending-tmp').val();\n        var itemsArr = [];\n        $('.js-check-video').each(function(i,item){\n          var item = $(item);\n          if(item.prop('checked')===true){\n            itemsArr.push({id: item.val()});\n          }\n        });\n\n        if(!videoTmpId){\n          return false;\n        }\n\n        $('.js-template').val('');\n        localStorage.removeItem('template');\n\n        loadOn();\n        var group = $('.js-tab-item.current').data('tab').split(',')[1];\n\n        chrome.runtime.sendMessage({action: \"get_tmp_calls\", token: token, id: videoTmpId}, function(response){\n\n          if(response.description === 'error'){\n            if(response.error.status === 0){\n              showPopup('You are not authorized');\n            }else if(response.error.status === 400){\n              showPopup('Something wrong!');\n            }\n\n            loadOff();\n          }else{\n            var parser = new DOMParser();\n            var doc = parser.parseFromString(response, \"text/html\");\n    \n            if(!$(response.documentElement).find('annotation[type=\"promotion\"] data').length){ \n              loadOff();\n              showPopup('No image on this video!');\n              return false; \n            }\n\n            var overlay = JSON.parse($(response.documentElement).find('annotation[type=\"promotion\"] data')[0].innerHTML).image_url.split('/');\n            itemImg = overlay[overlay.length - 1].split('.')[0];\n    \n            ytId = JSON.parse($(response.documentElement).find('annotation[type=\"branding\"] data')[0].innerHTML).channel_id;\n\n            if(ytId != localStorage.getItem('call_ch_id')){\n              showPopup('Use the correct account!');\n              $('.js-check-all').prop('checked',false);\n              loadOff();\n              return false;\n            }\n            loadOff();\n          }\n          \n        });\n\n      })\n\n      $('body').on('click','.js-revert-all-btn',function(){\n        var videoObj = {};\n\n        var itemsArr = [];\n        $('.js-check-video').each(function(i,item){\n          var item = $(item);\n          if(item.prop('checked')===true){\n            itemsArr.push({id: item.val()});\n          }\n        });\n\n        if(!itemsArr.length){\n          return false;\n        }\n        loadOn();\n        var token = getCookie('call_auth_token_'+ytId);\n        if (!token){\n          checkUser();\n        }\n        var group = $('.js-tab-item.current').data('tab').split(',')[1];\n        $.each(itemsArr,function(idx,item){\n          var data = JSON.parse(localStorage.getItem('template'));\n          data.push({'name': 'video_id', 'value': item.id});\n          data.push({'name': 'session_token', 'value': token});\n\n          for(var j in data){\n            if(data[j].name == 'cta_display_url' || data[j].name == 'cta_destination_url' || data[j].name == 'cta_text1'){\n              data[j].value = '';\n            }\n          }\n\n          chrome.runtime.sendMessage({action: \"revert_calls\", data: data}, function(response){\n            \n            if(response.error){\n              $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n              $('.b-list-item[data-id=\"'+item.id+'\"] input').prop('checked',false);\n              $('.js-check-all').prop('checked',false);\n\n              loadOff();\n            }else{\n              $.get('/admin/call_to_action?action=annotate&video_id='+item.id+'&is_promo=false&channel_id='+ytId).then(function(resp){\n                $('.b-list-item[data-id=\"'+item.id+'\"]').slideUp(200, function(){\n                  $(this).remove();\n                });\n\n                loadOff();\n              });\n            }\n          });\n          \n        })\n      });\n\n      $('body').on('click','.js-pub-all-btn',function(){\n        var videoObj = {};\n\n        var itemsArr = [];\n        $('.js-check-video').each(function(i,item){\n          var item = $(item);\n          if(item.prop('checked')===true){\n            itemsArr.push({id: item.val()});\n          }\n        });\n\n        if(!itemsArr.length || !$('.js-template').val()){\n          return false;\n        }\n        loadOn();\n        var token = getCookie('call_auth_token_'+ytId);\n        if (!token){\n          checkUser();\n        }\n        var group = $('.js-tab-item.current').data('tab').split(',')[1];\n        $.each(itemsArr,function(idx,item){\n          var data = JSON.parse(localStorage.getItem('template'));\n          data.push({'name': 'video_id', 'value': item.id});\n          data.push({'name': 'session_token', 'value': token});\n\n          for(var j in data){\n            if(data[j].name == 'cta_image_id'){\n              data[j].value = itemImg;\n            }\n          }\n\n          chrome.runtime.sendMessage({action: \"pub_calls\", data: data}, function(response){\n\n            var is_promo;\n            if ($('.js-tab-item[data-tab=\"short,2\"]').hasClass('current')){\n              is_promo = true;\n            }else{\n              is_promo = false;\n            }\n\n            if((response.metadata_errors && response.metadata_errors.length) || response.error){\n              $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n              $('.b-list-item[data-id=\"'+item.id+'\"] input').prop('checked',false);\n              $('.js-check-all').prop('checked',false);\n\n              try{\n                showPopup(resp.metadata_errors[0].message);\n              }catch(e){console.log(e)}\n\n              loadOff();\n\n            }else{\n              $.get('/admin/call_to_action?action=annotate&video_id='+item.id+'&is_promo='+is_promo+'&channel_id='+ytId).then(function(){\n                loadOff();\n\n                if(is_promo){\n                  $('.b-list-item[data-id=\"'+item.id+'\"] input').prop('checked',false);\n                  $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('suc');\n                  setTimeout(function(){\n                    $('.b-list-item[data-id=\"'+item.id+'\"]').removeClass('suc');\n                  },700);\n                }else{\n                  $('.b-list-item[data-id=\"'+item.id+'\"]').slideUp(200, function(){\n                    $(this).remove();\n                  });\n                }\n              });\n            }\n          });\n        \n        })\n      });\n\n    })\n\n  }else if(matchEndings){\n    $(function(){\n      $('body').on('click','.js-get-tmp-btn',function(){\n        var token = $('.js-auth-token').val();\n        var videoTmpId = $('.js-ending-tmp').val();\n        var itemsArr = [];\n        $('.js-check-video').each(function(i,item){\n          var item = $(item);\n          if(item.prop('checked')===true){\n            itemsArr.push({id: item.val()});\n          }\n        });\n\n        if(!videoTmpId || !itemsArr.length){\n          return false;\n        }\n        loadOn();\n        var group = $('.js-tab-item.current').data('tab').split(',')[1];\n        $.each(itemsArr,function(idx,item){\n          itemsObj[group+'_end_'+item.id] = {};\n\n          chrome.runtime.sendMessage({action: \"get_tmp_endings\", id: item.id, tmpId: videoTmpId, token: token}, function(response){\n            loadOff();\n\n            if(response.for_editor){\n              itemsObj[group+'_end_'+item.id] = response.for_editor;\n    \n              $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('suc').removeClass('err');\n            }else{\n              if(response.description === 'error' && response.error.status === 0){\n                showPopup('You are not authorized');\n              }else if(response.error.status === 400){\n                showPopup('Something wrong!');\n              }\n\n              loadOff();\n              $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n              $('.b-list-item[data-id=\"'+item.id+'\"] input').prop('checked',false);\n              $('.js-check-all').prop('checked',false);\n            }\n          });\n        })\n\n      })\n      $('body').on('click','.js-revert-all-btn',function(){\n        var videoObj = {};\n\n        var itemsArr = [];\n        $('.js-check-video').each(function(i,item){\n          var item = $(item);\n          if(item.prop('checked')===true){\n            itemsArr.push({id: item.val()});\n          }\n        });\n\n        if(!itemsArr.length){\n          return false;\n        }\n        loadOn();\n        var token = getCookie('annotation_auth_token_'+ytId);\n        if (!token){\n          checkUser();\n        }\n        var group = $('.js-tab-item.current').data('tab').split(',')[1];\n        $.each(itemsArr,function(idx,item){\n          if(!itemsObj[group+'_end_'+item.id]) {\n            loadOff();\n            $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n          }else{\n            videoObj[item.id] = itemsObj[group+'_end_'+item.id];\n            videoObj[item.id]['encrypted_video_id'] = item.id;\n            videoObj[item.id]['action_save'] = 1;\n            videoObj[item.id]['v'] = item.id;\n\n            videoObj[item.id]['session_token'] = token\n\n            chrome.runtime.sendMessage({action: \"revert_endings\", id: item.id, videoObj: videoObj[item.id]}, function(response){\n              \n              if(response.body === 'ok'){\n                $.get('/admin/annotations?action=annotate&video_id='+item.id+'&is_promo=false&channel_id='+ytId).then(function(){\n                  $('.b-list-item[data-id=\"'+item.id+'\"]').slideUp(200, function(){\n                    $(this).remove();\n                  });\n\n                  loadOff();\n                });\n              }else{\n                $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n                $('.b-list-item[data-id=\"'+item.id+'\"] input').prop('checked',false);\n                $('.js-check-all').prop('checked',false);\n\n                loadOff();\n              }\n            });\n          }\n        })\n      });\n\n      $('body').on('click','.js-pub-all-btn',function(){\n        var videoObj = {};\n\n        var itemsArr = [];\n        $('.js-check-video').each(function(i,item){\n          var item = $(item);\n          if(item.prop('checked')===true){\n            itemsArr.push({id: item.val()});\n          }\n        });\n\n        if(!itemsArr.length){\n          return false;\n        }\n        loadOn();\n        var token = getCookie('annotation_auth_token_'+ytId);\n        if (!token){\n          checkUser();\n        }\n        var group = $('.js-tab-item.current').data('tab').split(',')[1];\n        $.each(itemsArr,function(idx,item){\n          if(!itemsObj[group+'_end_'+item.id]) {\n            loadOff();\n            $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n          }else{\n            videoObj[item.id] = itemsObj[group+'_end_'+item.id];\n            videoObj[item.id]['encrypted_video_id'] = item.id;\n            videoObj[item.id]['action_save'] = 1;\n            videoObj[item.id]['v'] = item.id;\n\n            videoObj[item.id]['session_token'] = token\n\n            chrome.runtime.sendMessage({action: \"pub_endings\", id: item.id, videoObj: videoObj[item.id]}, function(response){\n              var is_promo;\n              if ($('.js-tab-item[data-tab=\"short,2\"]').hasClass('current')){\n                is_promo = true;\n              }else{\n                is_promo = false;\n              }\n\n              if(response.error || response.errors){\n                $('.b-list-item[data-id=\"'+item.id+'\"]').addClass('err');\n                $('.b-list-item[data-id=\"'+item.id+'\"] input').prop('checked',false);\n                $('.js-check-all').prop('checked',false);\n\n                loadOff();\n              }else{\n                $.get('/admin/annotations?action=annotate&video_id='+item.id+'&is_promo='+is_promo+'&channel_id='+ytId).then(function(){\n                  $('.b-list-item[data-id=\"'+item.id+'\"]').slideUp(200, function(){\n                    $(this).remove();\n                  });\n                  loadOff();\n                });\n              }\n            });\n            \n          }\n\n        })\n      });\n\n    })\n  }\n\n  var cookie_name,\n    ch_id_name,\n    tollName;\n\n  if(match){\n    if(match[0] == 'call_to_action'){\n      cookie_name = 'call_auth_token_';\n      ch_id_name = 'call_ch_id';\n      tollName = 'Call To Action';\n    }else{\n      cookie_name = 'annotation_auth_token_';\n      ch_id_name = 'ann_ch_id';\n      tollName = 'Endings';\n    }\n    var list = document.getElementsByClassName(\"b-content\");\n    var newLi = document.createElement('div');\n    newLi.setAttribute(\"class\", \"js-get-token\");\n    newLi.onclick = function(e){\n      e.preventDefault();\n      \n      checkUser();\n      \n    };\n    newLi.innerHTML = 'Get token';\n    list[0].appendChild(newLi);\n\n    function checkUser(){\n      loadOn();\n\n\n      chrome.runtime.sendMessage({action: \"get_id\"}, function(response){\n        getChannelId(response);\n      });\n    }\n\n    function getChannelId(response) {\n      var parser = new DOMParser();\n      var doc = parser.parseFromString(response, \"text/html\");\n      var elArr = Array.prototype.slice.call(doc.getElementsByTagName(\"script\"));\n      var sText = elArr.filter(function(el){return el.textContent.indexOf(\"GUIDED_HELP\") > -1;});\n\n      try {\n        sText = sText[0].textContent.split('var ytInitialGuideData = JSON.parse(')[1].split(');')[0];\n        sText = JSON.parse(sText);\n        sText = JSON.parse(sText);\n\n        var serviceParams = sText.responseContext.serviceTrackingParams;\n\n        serviceParams.forEach(function(item) {\n          if (item.service === 'GUIDED_HELP') {\n            ytId = item.params[0].value;\n          }\n        });\n\n        if (ytId) {\n          getChannelTitle(ytId);\n\n          checkAuthState(elArr,ytId);\n\n          return;\n        } else{\n          throw new Error('no channel ID');\n        }\n\n      } catch(e) {\n        console.log(e);\n      }\n\n      sText = elArr.filter(function(el){return el.textContent.indexOf(\"GUIDED_HELP\") > -1;});\n\n      if(sText[0].textContent.indexOf('creator_channel_id\",\"value\":\"') > -1){\n        ytId = /creator_channel_id\",\"value\":\"([^\"]+)\"/.exec(sText[0].textContent)[1];\n      }else{\n        ytId = $(doc).find('.spf-link[title=\"Мой канал\"]').attr('href') || $(doc).find('.spf-link[title=\"My channel\"]').attr('href');\n        ytId = ytId.split('/channel/')[1]\n        // sText = elArr.filter(function(el){return el.textContent.indexOf(\"GAPI_HINT_PARAMS\") > -1;});\n        // ytId = /creator_channel_id\":\"([^\"]+)\"/.exec(sText[0].textContent)[1];\n      }\n      \n\n      getChannelTitle(ytId);\n\n      checkAuthState(elArr,ytId);\n    }\n\n    function getChannelTitle(id) {\n      chrome.runtime.sendMessage({action: \"get_title\", id: id}, function(response){\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(response, \"text/html\");\n\n        var title = '';\n\n        if(doc.getElementsByTagName(\"title\")[1]){\n          title = doc.getElementsByTagName(\"title\")[1].text;\n        }else{\n          title = doc.getElementsByTagName(\"title\")[0].text;\n        }\n\n        $('.js-channel-title').html(tollName+'&nbsp;-&nbsp;'+title);\n      });\n    }\n\n    function checkAuthState(scripts,ytId) {\n      var listWrap = document.getElementsByClassName('b-list-wrap')[0];\n      var tokenInp = document.getElementsByClassName('js-auth-token')[0];\n\n      var tagText = scripts.filter(function(el){return el.textContent.indexOf(\"GAPI_HINT_PARAMS\") > -1;});\n\n      if(typeof tagText[0] === 'undefined'){\n        alert('Auth token error!')\n        listWrap.setAttribute('id','disable');\n        listWrap.innerHTML = '';\n        loadOff();\n        return false;\n      }\n\n      var auth_token = '';\n      if(tagText[0].textContent.indexOf('\"XSRF_TOKEN\"') > -1){\n        auth_token = /XSRF_TOKEN\":\"([^\"]+)\"/.exec(tagText[0].textContent)[1]\n      }else{\n        tagText = scripts.filter(function(el){return el.textContent.indexOf(\"GOOGLE_HELP_CONTEXT\") > -1;});\n        auth_token = /XSRF_TOKEN': \"([^\"]+)\"/.exec(tagText[0].textContent)[1]\n      }\n\n      tokenInp.value = auth_token;\n      setCookie(ytId,auth_token);\n      loadOff();\n\n      checkChannelId(ytId);\n    }\n\n    function checkChannelId(ytId) {\n      var listWrap = document.getElementsByClassName('b-list-wrap')[0];\n      \n      if(localStorage.getItem(ch_id_name) != ytId){\n        localStorage.setItem(ch_id_name,ytId);\n        $('.js-tab-item.current').trigger('click');\n      }else{\n        localStorage.setItem(ch_id_name,ytId);\n      }\n\n      if(startState){\n        $('.js-tab-item.current').trigger('click');\n        startState = false;\n      }\n\n      listWrap.setAttribute('id','');\n    }\n\n    function setCookie(channelId,auth_token) { \n      var now = new Date();\n      var time = now.getTime();\n      var expireTime = time + 1000*3300;\n      now.setTime(expireTime);\n      document.cookie = cookie_name+channelId+\"=\"+auth_token+\"; path=/; expires=\" + now.toGMTString();\n    }\n  }\n\n  function showPopup(text){\n    $('.b-popup').addClass('_show');\n    $('.b-popup-box').html(text);\t\n    setTimeout(function(){\n      hidePopup();\n    },1500);\n  }\n\n  function hidePopup(){\n    $('.b-popup').removeClass('_show');\t\n  }\n\n  function loadOn(){\n    $('.b-loader').show();\t\n  }\n\n  function loadOff(){\n    $('.b-loader').hide();\t\n  }\n\n  function getCookie(name) {\n    var matches = document.cookie.match(new RegExp(\n      \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n    ));\n    return matches ? decodeURIComponent(matches[1]) : undefined;\n  }\n\n  var videoSettings = [\n    {\"name\":\"title\",\"value\":\"\"},\n    {\"name\":\"description\",\"value\":\"\"},\n    {\"name\":\"keywords\", \"value\": \"\"},\n    {\"name\":\"privacy\",\"value\":\"public\"},\n    {\"name\":\"notify_via_email\",\"value\":\"true\"},\n    {\"name\":\"share_emails\",\"value\":\"\"},\n    {\"name\":\"deleted_ogids\",\"value\":\"\"},\n    {\"name\":\"deleted_circle_ids\",\"value\":\"\"},\n    {\"name\":\"deleted_emails\",\"value\":\"\"},\n    {\"name\":\"playlists_values\",\"value\":\"InvalidValue\"},\n    {\"name\":\"privacy_draft\",\"value\":\"\"},\n    {\"name\":\"still_id\",\"value\":\"0\"},\n    {\"name\":\"thumbnail_preview_version\",\"value\":\"\"},\n    {\"name\":\"claim_style\",\"value\":\"ads\"},\n    {\"name\":\"claim_usage_policy\",\"value\":\"S526445693826128\"},\n    {\"name\":\"claim_match_policy\",\"value\":\"\"},\n    {\"name\":\"allow_comments\",\"value\":\"yes\"},\n    {\"name\":\"allow_comments_detail\",\"value\":\"all\"},\n    {\"name\":\"allow_comments_sort_order\",\"value\":\"top_comments\"},\n    {\"name\":\"allow_ratings\",\"value\":\"yes\"},\n    {\"name\":\"reuse\",\"value\":\"all_rights_reserved\"},\n    {\"name\":\"captions_certificate_reason\",\"value\":\"\"},\n    {\"name\":\"allow_embedding\",\"value\":\"yes\"},\n    {\"name\":\"location_longitude\",\"value\":\"\"},\n    {\"name\":\"location_latitude\",\"value\":\"\"},\n    {\"name\":\"location_altitude\",\"value\":\"\"},\n    {\"name\":\"audio_language\",\"value\":\"ru\"},\n    {\"name\":\"recorded_date\",\"value\":\"\"},\n    {\"name\":\"cta_text1\",\"value\":\"Богатейшие кланы России\"},\n    {\"name\":\"cta_text2\",\"value\":\"text2\"},\n    {\"name\":\"cta_text3\",\"value\":\"text3\"},\n    {\"name\":\"cta_image_id\",\"value\":\"1504107731885497\"},\n    {\"name\":\"cta_display_url\",\"value\":\"www.vesti.ru\"},\n    {\"name\":\"cta_destination_url_scheme\",\"value\":\"http://\"},\n    {\"name\":\"cta_destination_url\",\"value\":\"www.vesti.ru/doc.html?id=2926720&utm_source=youtube&utm_medium=banner&utm_campaign=youtube-banner\"},\n    {\"name\":\"cta_enabled_on_mobile\",\"value\":\"yes\"},\n    {'name': 'modified_fields', 'value': 'cta_enabled_on_mobile,cta_display_url,cta_destination_url_scheme,cta_destination_url,cta_image_id'},\n    {'name': 'allow_public_stats', 'value': 'no'},\n    {'name': 'captions_crowdsource', 'value': 'no'},\n    {'name': 'self_racy', 'value': 'no'},\n    {'name': 'creator_share_feeds', 'value': 'yes'},\n    {'name': 'claim_match_enabled', 'value': 'no'}\n  ]\n\n  localStorage.setItem('videoSettings',JSON.stringify(videoSettings));\n}","export function loadOn() {\n  $(\".b-loader\").show();\n}\n\nexport function showPopup(text) {\n  $(\".b-popup\").addClass(\"_show\");\n  $(\".b-popup-box\").html(text);\n  setTimeout(() => {\n    hidePopup();\n  }, 1500);\n}\n\nexport function hidePopup() {\n  $(\".b-popup\").removeClass(\"_show\");\n}\n\nexport function loadOff() {\n  $(\".b-loader\").hide();\n}\n\nexport function getCookie(name) {\n  var matches = document.cookie.match(\n    new RegExp(\n      \"(?:^|; )\" +\n        name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, \"\\\\$1\") +\n        \"=([^;]*)\"\n    )\n  );\n  return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nexport function localStorageSetItem(key, value) {\n  if (!value) return;\n  \n  let oldArray = localStorageGetItem(key);\n  \n  if (!oldArray) {\n    oldArray = [];\n  }\n\n  const newArray = unique(oldArray.concat(value));\n\n  localStorage.setItem(key, JSON.stringify(newArray));\n}\n\nexport function localStorageGetItem(key) {\n  return JSON.parse(localStorage.getItem(key));\n}\n\nfunction unique(arr) {\n  var i,\n      len = arr.length,\n      out = [],\n      obj = { };\n  \n  for (i = 0; i < len; i++) {\n      obj[arr[i]] = 0;\n  }\n  for (i in obj) {\n      out.push(i);\n  }\n  return out;\n};","import content from './cards';\nimport endings from './endings';\n\nconst page = /cards/;\nconst match = page.exec(document.URL);\n\nif(match){\n  content();\n}\n\nendings();"],"sourceRoot":""}