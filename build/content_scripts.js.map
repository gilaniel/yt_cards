{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/content_scripts.js","webpack:///./src/helpers.js","webpack:///./src/index.js"],"names":["listItemTmp","item","cookie_name","ch_id_name","channelId","videos","topPlVideos","newVideos","mostViewedVideos","ytVideos","cardsTemplates","doneVideoCount","templates","IDS","MESSAGES","TEASERS","COPY_IDS","PL_IDS","checkUser","loadOn","$","append","chrome","runtime","sendMessage","action","response","getChannelId","getTemplates","elArr","getYtScripts","parser","DOMParser","doc","parseFromString","sText","filter","el","textContent","indexOf","split","JSON","parse","serviceParams","responseContext","serviceTrackingParams","forEach","service","ytId","params","value","checkAuthState","Error","e","console","log","exec","find","attr","getChannelTitle","id","title","getElementsByTagName","text","html","loadOff","scripts","tagText","alert","auth_token","setCookie","localStorage","setItem","getVideos","page","promiseArr","elements","time","length","push","splice","video","playlistVideoRenderer","videoId","lengthSeconds","checkVideoCard","Promise","all","then","removeClass","getTopPlVideos","plId","ytData","contents","twoColumnBrowseResultsRenderer","tabs","tabRenderer","content","sectionListRenderer","itemSectionRenderer","playlistVideoListRenderer","findVideo","element","results","localStorageSetItem","videoPromise","resolve","reject","v","feature_templates","key","setCard","allVideos","idx","array","video_item_id","custom_message","teaser_text","error","notify","message","type","css","clearCard","session_token","getCookie","Array","prototype","slice","call","copyCards","fillCards","each","video_id","playlist_id","channel_url","val","now","Date","getTime","expireTime","setTime","document","cookie","toGMTString","localStorageGetItem","lists","toLowerCase","getParams","links","i","messages","teasers","start_ms","videoData","show_warnings","video_url","lengthStep","Math","round","action_create_video","action_create_collaborator","on","preventDefault","addClass","concat","clearArray","filledArray","filledArrayToClear","cards","k","size","clearSubArray","filledSubArray","ceil","setCardPromise","reduce","previousPromise","subItem","has_card","set","currentTarget","dataset","btn","toggleClass","hasClass","closest","checked","prop","show","showPopup","setTimeout","hidePopup","hide","name","matches","match","RegExp","replace","decodeURIComponent","undefined","oldArray","newArray","unique","stringify","getItem","arr","len","out","obj","URL"],"mappings":"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","file":"content_scripts.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","import { loadOn } from \"./helpers\";\nimport { loadOff } from \"./helpers\";\nimport { getCookie } from \"./helpers\";\nimport { localStorageSetItem } from \"./helpers\";\nimport { localStorageGetItem } from \"./helpers\";\n\nfunction listItemTmp (item) {\n  return `<div class=\"js-list-item\">${item}</div>`;\n}\n\nexport default function() {\n  const cookie_name = \"tools_auth_token_\";\n  const ch_id_name = \"tools_channel_id\";\n  let channelId = \"\";\n  let videos = [];\n  let topPlVideos = [];\n  let newVideos = [];\n  let mostViewedVideos = [];\n  let ytVideos = [];\n  let cardsTemplates = [];\n  let doneVideoCount = 0;\n  const templates = {\n    IDS: [],\n    MESSAGES: [],\n    TEASERS: [],\n    COPY_IDS: [],\n    PL_IDS: []\n  }\n\n  checkUser();\n\n  function checkUser() {\n\n    loadOn();\n\n    $('body').append('<script id=\"initApp\"></script>')\n\n    chrome.runtime.sendMessage({ action: \"get_id\" }, response => {\n      getChannelId(response);\n    });\n\n    getTemplates();\n  }\n\n  function getChannelId(response) {\n    const elArr = getYtScripts(response);\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(response, \"text/html\");\n\n    let sText = elArr.filter(function(el) {\n      return el.textContent.indexOf(\"GUIDED_HELP\") > -1;\n    });\n\n    try {\n\t\t\tsText = sText[0].textContent.split('var ytInitialGuideData = JSON.parse(')[1].split(');')[0];\n\t\t\tsText = JSON.parse(sText);\n\t\t\tsText = JSON.parse(sText);\n\n\t\t\tconst serviceParams = sText.responseContext.serviceTrackingParams;\n\n\t\t\tserviceParams.forEach(function(item) {\n\t\t\t\tif (item.service === 'GUIDED_HELP') {\n\t\t\t\t\tytId = item.params[0].value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (ytId) {\n\t\t\t\tcheckAuthState(elArr,channelId);\n\n\t\t\t\treturn;\n\t\t\t} else{\n\t\t\t\tthrow new Error('no channel ID');\n\t\t\t}\n\n\t\t} catch(e) {\n\t\t\tconsole.log(e)\n    }\n    \n    sText = elArr.filter(function(el){return el.textContent.indexOf(\"GUIDED_HELP\") > -1;});\n\n\n    if (sText[0].textContent.indexOf('creator_channel_id\",\"value\":\"') > -1) {\n      channelId = /creator_channel_id\",\"value\":\"([^\"]+)\"/.exec(\n        sText[0].textContent\n      )[1];\n    } else {\n      channelId = $(doc).find('.spf-link[title=\"Мой канал\"]').attr('href') || $(doc).find('.spf-link[title=\"My channel\"]').attr('href');\n\t\t\tchannelId = channelId.split('/channel/')[1];\n    }\n\n    checkAuthState(elArr, channelId);\n  }\n\n  function getChannelTitle(channelId) {\n    chrome.runtime.sendMessage(\n      { action: \"get_title\", id: channelId },\n      response => {\n        var parser = new DOMParser();\n        var doc = parser.parseFromString(response, \"text/html\");\n        var title = \"\";\n\n        if (doc.getElementsByTagName(\"title\")[1]) {\n          title = doc.getElementsByTagName(\"title\")[1].text;\n        } else {\n          title = doc.getElementsByTagName(\"title\")[0].text;\n        }\n\n        $(\".channel-title\").html(title);\n\n        // getVideos(1);\n\n        loadOff();\n      }\n    );\n  }\n\n  function checkAuthState(scripts, channelId) {\n    let tagText = scripts.filter(function(el) {\n      return el.textContent.indexOf(\"GAPI_HINT_PARAMS\") > -1;\n    });\n\n    if (typeof tagText[0] === \"undefined\") {\n      alert(\"Auth token error!\");\n      loadOff();\n      return false;\n    }\n\n    let auth_token = \"\";\n    if (tagText[0].textContent.indexOf('\"XSRF_TOKEN\"') > -1) {\n      auth_token = /XSRF_TOKEN\":\"([^\"]+)\"/.exec(tagText[0].textContent)[1];\n    } else {\n      tagText = scripts.filter(function(el) {\n        return el.textContent.indexOf(\"GOOGLE_HELP_CONTEXT\") > -1;\n      });\n      auth_token = /XSRF_TOKEN': \"([^\"]+)\"/.exec(tagText[0].textContent)[1];\n    }\n\n    setCookie(channelId, auth_token);\n\n    // getVideos();\n\n    getChannelTitle(channelId);\n\n    localStorage.setItem(ch_id_name, channelId);\n  }\n\n  function getVideos(page, params = '') {\n    loadOn();\n\n    const promiseArr = [];\n    ytVideos = [];\n\n    chrome.runtime.sendMessage(\n      { action: \"get_new_videos\", page: page, params: params },\n      response => {\n        const elArr = getYtScripts(response);\n        const parser = new DOMParser();\n\n        const sText = elArr.filter(function(el) {\n          return el.textContent.indexOf(\"VIDEO_LIST_DISPLAY_OBJECT\") > -1;\n        });\n        \n        let elements = sText[0].textContent.split('VIDEO_LIST_DISPLAY_OBJECT\":')[1].split('}]')[0]+'}]';\n        elements = JSON.parse(elements);\n\n        elements.forEach((item) => {\n          const id = item.id;\n          item = parser.parseFromString(item.html, \"text/html\");\n          let time = $(item).find('.video-time').text().split(':');\n\n          if (!time) return;\n\n          if (time.length > 2) {\n            time = +(time[0]) * 60 * 60 + +(time[1]) * 60 + +(time[2]);\n          }else{\n            time = +(time[0]) * 60 + +(time[1]);\n          }\n\n          videos.push([id, time]);\n        });\n\n        elements.length < 25 ? page = 3 : page ++;\n        \n        if (page <= 2) {\n          getVideos(page, params);\n        }\n\n        if (page === 3) {\n          videos = videos.splice(0,50);\n\n          videos.forEach(item => {\n            let video = {\n              playlistVideoRenderer: {\n                videoId: item[0],\n                lengthSeconds: item[1]\n              }\n            };\n    \n            ytVideos.push(video);\n    \n            checkVideoCard(item[0], video, promiseArr);         \n          });\n\n          Promise.all(promiseArr).then(()=>{\n            loadOff();\n\n            if (params) {\n              mostViewedVideos = ytVideos;\n\n              $('.js-most-videos-count').removeClass('hide');\n              $(\".js-most-count\").text(mostViewedVideos.length);\n            }else {\n              newVideos = ytVideos;\n              \n              $('.js-all-videos-count').removeClass('hide');\n              $(\".js-all-count\").text(newVideos.length);\n            }\n          });\n        }\n\n      });\n  }\n\n  function getTopPlVideos(plId) {\n    loadOn();\n\n    ytVideos = [];\n\n    chrome.runtime.sendMessage(\n      { action: \"get_pl_videos\", plId: plId },\n      response => {\n        try {\n          const elArr = getYtScripts(response);\n\n          const sText = elArr.filter(function(el) {\n            return el.textContent.indexOf(\"responseContext\") > -1;\n          });\n  \n          const ytData = sText[0].textContent\n            .split('window[\"ytInitialData\"] = ')[1]\n            .split(\";\");\n          topPlVideos = JSON.parse(ytData[0]).contents\n            .twoColumnBrowseResultsRenderer.tabs[0].tabRenderer.content\n            .sectionListRenderer.contents[0].itemSectionRenderer.contents[0]\n            .playlistVideoListRenderer.contents;\n  \n          const promiseArr = [];\n  \n          topPlVideos.forEach(item => {\n            const video = item.playlistVideoRenderer;\n            const findVideo = newVideos.find(function(element) {\n              return element.playlistVideoRenderer.videoId == video.videoId;\n            });\n\n            if (findVideo || !video.lengthSeconds) { return; }\n  \n            ytVideos.push(item);\n          });\n\n          ytVideos.forEach(item => {\n            const video = item.playlistVideoRenderer;\n\n            checkVideoCard(video.videoId, item, promiseArr);   \n          });\n\n          topPlVideos = ytVideos;\n\n          Promise.all(promiseArr).then((results)=>{\n            loadOff();\n  \n            // ytVideos = ytVideos.concat(topPlVideos);\n            \n            $('.js-pl-videos-count').removeClass('hide');\n            $('.js-playlist-count').text(topPlVideos.length);\n  \n            localStorageSetItem('PL_IDS', plId);\n\n            getTemplates();\n          });\n        }catch(e) {\n          loadOff();\n          \n          alert('Wrong Playlist or something else. Please contact Gila.');\n        }\n      }\n    );\n  }\n\n  function checkVideoCard(videoId, item, promiseArr) {\n    let videoPromise = new Promise((resolve, reject) =>{\n      chrome.runtime.sendMessage(\n        { action: \"check_card\", v: videoId },\n        response => {\n          item[\"cards\"] = [];\n\n          if (\n            response.feature_templates &&\n            response.feature_templates.length &&\n            response.feature_templates[0].key\n          ) {\n            item[\"has_card\"] = true;\n            item[\"cards\"] = response.feature_templates;\n          }\n\n          $(\".js-videos-count\").removeClass(\"hide\");\n\n          resolve(item);\n        }\n      );\n    });\n\n    promiseArr.push(videoPromise);\n  }\n\n  function setCard(videos, allVideos) {\n    return new Promise((resolve, reject) => {\n\n      videos.forEach((item, idx, array) => {\n        chrome.runtime.sendMessage(\n          { action: \"set_card\", v: item.video.playlistVideoRenderer.videoId, params: item.params },\n          (response) => {\n  \n            localStorageSetItem('IDS', item.params.video_item_id);\n            localStorageSetItem('MESSAGES', item.params.custom_message);\n            localStorageSetItem('TEASERS', item.params.teaser_text);\n  \n            if (response.error) {\n              console.log(response);\n              $.notify({message: 'Set card error: ' + response.videoId},{type: 'danger'});\n\n              reject();\n              \n              return;\n            }\n\n            const video = ytVideos.find(function(element) {\n              return element.playlistVideoRenderer.videoId == item.video.playlistVideoRenderer.videoId;\n            });\n\n            const templates = response\n                .split('response\">')[1]\n                .split(\"</textarea>\")[0];\n\n            video[\"cards\"] = JSON.parse(templates).feature_templates;\n\n            doneVideoCount++;\n\n            $('.progress-bar-fill').css('width',100 * (doneVideoCount) / allVideos.length + '%');\n\n            if (idx === array.length -1) {\n              console.log('done');\n              resolve();\n            }\n          }\n        );\n      });\n    });\n\n    promiseArr.push(videoPromise);\n  }\n\n  function clearCard(videos) {\n    return new Promise((resolve, reject) => {\n      videos.forEach((item, idx, array) => {\n        \n        let params = {\n          key: item.key,\n          session_token: getCookie(cookie_name + channelId)\n        };\n\n        chrome.runtime.sendMessage(\n          { action: \"clear_card\", v: item.id, params: params },\n          (response) => {\n            if (response.error) {\n              $.notify({message: 'Clear card error: ' + response.videoId},{type: 'danger'});\n\n              reject();\n              \n              return;\n            }\n\n            const video = ytVideos.find(function(element) {\n              return element.playlistVideoRenderer.videoId == item.id;\n            });\n\n            video[\"cards\"] = response.feature_templates;\n\n            if (idx === array.length - 1) {\n              resolve();\n            }\n          }\n        );\n      });\n    });\n  }\n\n  function getYtScripts(response) {\n    const parser = new DOMParser();\n    const doc = parser.parseFromString(response, \"text/html\");\n    const elArr = Array.prototype.slice.call(doc.getElementsByTagName(\"script\"));\n\n    return elArr;\n  }\n\n  function copyCards(videoId) {\n    loadOn();\n\n    chrome.runtime.sendMessage(\n      { action: \"check_card\", v: videoId },\n      (response) => {\n        if (\n          response.feature_templates &&\n          response.feature_templates.length &&\n          response.feature_templates[0].key\n        ) {\n          cardsTemplates = response.feature_templates;\n\n          fillCards();\n\n          localStorageSetItem('COPY_IDS', videoId);\n\n          getTemplates();\n\n        }else{\n          alert('Bad Video Id: ' + videoId);\n        }\n\n        loadOff();\n      });\n  }\n\n  function fillCards() {\n    $('.card-block').each((idx,item) => {\n      if (!cardsTemplates[idx]) return;\n\n      let id = cardsTemplates[idx].video_id || cardsTemplates[idx].playlist_id || cardsTemplates[idx].channel_url;\n      let custom_message = cardsTemplates[idx].custom_message ;\n      let teaser_text = cardsTemplates[idx].teaser_text ;\n      \n      item = $(item);\n\n      item.find('.video_item_id').val(id);\n      item.find('.custom_message').val(custom_message);\n      item.find('.teaser_text').val(teaser_text);\n    });\n  }\n\n  function setCookie(channelId, auth_token) {\n    var now = new Date();\n    var time = now.getTime();\n    var expireTime = time + 1000 * 3300;\n    now.setTime(expireTime);\n    document.cookie =\n      cookie_name +\n      channelId +\n      \"=\" +\n      auth_token +\n      \"; path=/; expires=\" +\n      now.toGMTString();\n  }\n\n  function getTemplates() {\n    templates.IDS = localStorageGetItem('IDS') || [];\n    templates.MESSAGES = localStorageGetItem('MESSAGES') || [];\n    templates.TEASERS = localStorageGetItem('TEASERS') || [];\n    templates.COPY_IDS = localStorageGetItem('COPY_IDS') || [];\n    templates.PL_IDS = localStorageGetItem('PL_IDS') || [];\n\n    $('.list-content').html('');\n\n    const lists = ['IDS', 'MESSAGES', 'TEASERS', 'COPY_IDS', 'PL_IDS'];\n\n    lists.forEach((item) => {\n      templates[item].forEach((value) => {\n        $(`.${item.toLowerCase()}-list`).append(listItemTmp(value));\n      });\n    });\n  }\n\n  function getParams(links, item, i) {\n    const messages = [];\n    const teasers = [];\n    const start_ms = [];\n\n    $(\".custom_message\").each((idx, item) => {\n      messages.push(item.value ? item.value : '');\n    });\n    \n    $(\".teaser_text\").each((idx, item) => {\n      teasers.push(item.value ? item.value : '');\n    });\n\n    $(\".start_ms\").each((idx, item) => {\n      start_ms.push(item.value ? item.value : '');\n    });\n\n    let videoData = item.playlistVideoRenderer;\n\n    let params = {\n      key: \"\",\n      type: \"video\",\n      start_ms: 30000,\n      show_warnings: true,\n      video_item_id: \"\",\n      video_url: \"\",\n      custom_message: \"\",\n      teaser_text: \"\",\n      session_token: getCookie(cookie_name + channelId)\n    };\n\n    let lengthStep = 120 * 1000;\n\n    if (videoData.lengthSeconds < 600) {\n      lengthStep = Math.round((videoData.lengthSeconds / 6) * 1000);\n\n      params.start_ms = lengthStep;\n    }\n\n    if (links[i].indexOf('youtube') > -1) {\n      delete params.action_create_video;\n      params['action_create_collaborator'] = 1;\n      params['channel_url'] = links[i];\n      params['type'] = 'collaborator';\n    }else {\n      delete params.channel_url;\n      delete params.action_create_collaborator;\n      params['action_create_video'] = 1;\n      params['type'] = 'video';\n    }\n    \n    params.video_item_id = links[i];\n    params.custom_message = messages[i];\n    params.teaser_text = teasers[i];\n\n    if (i > 0) {\n      params.start_ms += lengthStep * i;\n    }\n\n    if (start_ms[i]) {\n      let time = start_ms[i].split(':');\n\n      if (time.length > 2) {\n        time = +(time[0]) * 60 * 60 + +(time[1]) * 60 + +(time[2]);\n      }else{\n        time = +(time[0]) * 60 + +(time[1]);\n      }\n\n      params.start_ms = time * 1000;\n    }\n\n    return params;\n  }\n\n  // SET CARDS\n  $(\".js-set-card-btn\").on(\"click\", e => {\n    e.preventDefault();\n\n    const links = [];\n\n    $(\".video_item_id\").each((idx, item) => {\n      if (item.value) {\n        links.push(item.value);\n      }\n    });\n\n    if (!links.length || $('.b-input-error').length) return;\n\n    $('.progress-bar').addClass('_show');\n    $('.progress-bar-fill').css('width', 0 + '%');\n\n    ytVideos = topPlVideos.concat(newVideos).concat(mostViewedVideos);\n\n    doneVideoCount = 0;\n\n    const clearArray = [];\n    const filledArray = [];\n    const filledArrayToClear = [];\n\n    for (let i = 0; i < links.length; i++) {\n      ytVideos.forEach((item,idx) => {\n        const params = getParams(links, item, i);\n\n        clearArray.push({video: item, params: params});\n      });\n    }\n\n    ytVideos.forEach((item,idx) => {\n      if (item.cards.length) {\n        filledArray.push(item)\n      }\n    });\n    \n    for (let k = 0; k < 5; k++) {\n      filledArray.forEach((item, idx, array) => {\n        if (!item.cards[k]) return;\n\n        filledArrayToClear.push({id: item.playlistVideoRenderer.videoId, key: item.cards[k].key});\n      });\n    }\n\n    const size = 20;\n    const clearSubArray = [];\n    const filledSubArray = [];\n    \n    for (let i = 0; i <Math.ceil(clearArray.length/size); i++){\n      clearSubArray[i] = clearArray.slice((i*size), (i*size) + size);\n    }\n\n    for (let i = 0; i <Math.ceil(filledArrayToClear.length/size); i++){\n      filledSubArray[i] = filledArrayToClear.slice((i*size), (i*size) + size);\n    }\n\n    const setCardPromise = () => {\n      clearSubArray.reduce((previousPromise, subItem, idx, array) => {\n        return previousPromise.then(() => {\n          return setCard(subItem, clearArray).then(() => {\n            if (idx === array.length - 1) {\n              $('.progress-bar').removeClass('_show');\n\n              getTemplates();\n            }\n          });\n        }).catch(() => {\n          console.log('error');\n        });\n      }, Promise.resolve());\n    }\n\n    if (filledSubArray.length) {\n      filledSubArray.reduce((previousPromise, subItem, idx, array) => {\n        return previousPromise.then(() => {\n          return clearCard(subItem).then(() => {\n            if (idx === array.length - 1) {\n              setCardPromise();\n            }\n          });\n        }).catch(() => {\n          console.log('error');\n        });\n      }, Promise.resolve());\n\n      return;\n    }\n\n    setCardPromise();\n  });\n\n  // CLEAR CARDS\n  $(\".js-clear-card-btn\").on(\"click\", e => {\n    e.preventDefault();\n\n    ytVideos.reduce((previousPromise, item) => {\n      if (!item.has_card) {\n        return Promise.resolve();\n      }\n\n      return previousPromise.then(() => {\n        return clearCard({videoData: item.playlistVideoRenderer, video: item, set: false});\n      });\n    }, Promise.resolve());\n  });\n\n\n  $('.list-ico').on('click', (e) => {\n    const type = e.currentTarget.dataset.type;\n    const btn = $(e.currentTarget);\n\n    \n    btn.toggleClass('open');\n    \n    if (templates[type].length) {\n      if (btn.hasClass('open')) {\n        $('.list-block').closest('div').removeClass('focus');\n        btn.closest('div').addClass('focus');\n      }else {\n        $('.list-ico').removeClass('open');\n        btn.closest('div').removeClass('focus');\n      }\n      // $(e.currentTarget).closest('div').toggleClass('focus');\n    }\n  });\n\n  $('.js-get-last').on('click', () => {\n    videos = [];\n\n    getVideos(1);\n  });\n\n  $('.js-get-list').on('click', () => {\n    var plId = $('.js-pl-id').val();\n    if (!plId) return;\n\n    getTopPlVideos(plId);\n  });\n\n  $('.js-get-most-viewed').on('click', () => {\n    videos = [];\n    \n    getVideos(1, '&vmo=viewed&sa=0&sf=viewcount');\n  });\n\n  $('.js-copy-cards').on('click', () => {\n    var videoId = $('.js-video-id').val();\n\n    if (!videoId) return;\n\n    copyCards(videoId);\n  });\n\n  $('#pl-only').on('change', (e) => {\n    const checked = $(e.currentTarget).prop('checked');\n\n    if (checked) {\n      ytVideos = topPlVideos;\n    }else {\n      ytVideos = newVideos.concat(topPlVideos);\n    }\n  });\n}\n","export function loadOn() {\n  $(\".b-loader\").show();\n}\n\nexport function showPopup(text) {\n  $(\".b-popup\").addClass(\"_show\");\n  $(\".b-popup-box\").html(text);\n  setTimeout(() => {\n    hidePopup();\n  }, 1500);\n}\n\nexport function hidePopup() {\n  $(\".b-popup\").removeClass(\"_show\");\n}\n\nexport function loadOff() {\n  $(\".b-loader\").hide();\n}\n\nexport function getCookie(name) {\n  var matches = document.cookie.match(\n    new RegExp(\n      \"(?:^|; )\" +\n        name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, \"\\\\$1\") +\n        \"=([^;]*)\"\n    )\n  );\n  return matches ? decodeURIComponent(matches[1]) : undefined;\n}\n\nexport function localStorageSetItem(key, value) {\n  if (!value) return;\n  \n  let oldArray = localStorageGetItem(key);\n  \n  if (!oldArray) {\n    oldArray = [];\n  }\n\n  const newArray = unique(oldArray.concat(value));\n\n  localStorage.setItem(key, JSON.stringify(newArray));\n}\n\nexport function localStorageGetItem(key) {\n  return JSON.parse(localStorage.getItem(key));\n}\n\nfunction unique(arr) {\n  var i,\n      len = arr.length,\n      out = [],\n      obj = { };\n  \n  for (i = 0; i < len; i++) {\n      obj[arr[i]] = 0;\n  }\n  for (i in obj) {\n      out.push(i);\n  }\n  return out;\n};","import content from './content_scripts';\n\nconst page = /cards/;\nconst match = page.exec(document.URL);\n\nif(match){\n  content();\n}"],"sourceRoot":""}