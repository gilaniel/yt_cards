!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.d(t,"a",(function(){return r}));var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.port=5e3,this.develop=!1,this.url=this.develop?"http://127.0.0.1:"+port:"https://redmine.kedoo.com"}var t,n,r;return t=e,(n=[{key:"login",value:function(e){return $.post(this.url+"/login",e)}},{key:"addIssue",value:function(e){var t=new FormData;for(var n in e)t.append(n,e[n]);return $.ajax({type:"POST",url:this.url+"/add_issue",data:t,contentType:!1,processData:!1})}},{key:"fetchStatus",value:function(e){return $.post(this.url+"/status",e)}},{key:"fetchTasks",value:function(e){return $.post(this.url+"/issues",e)}},{key:"updateIssue",value:function(e){return $.post(this.url+"/update_issue",e)}}])&&o(t.prototype,n),r&&o(t,r),e}()},function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.r(t);var r=new(n(0).a),i=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id=chrome.app.getDetails().id,this.autorized=!1,this.api_key=!1}var t,n,a;return t=e,(n=[{key:"ui",value:function(){return{screenBtn:$(".js-make-screen-btn"),tasksBtn:$(".js-tasks-btn"),workBlock:$(".work-block"),loginForm:$(".login-form"),sendBtn:$(".js-send-btn"),error:$(".error"),loader:$(".loader")}}},{key:"fetchStatus",value:function(){var e=this;r.fetchStatus({key:this.api_key}).then((function(){e.autorized=!0,setTimeout((function(){e.toggleLoad(!0),e.showContent()}),500)}),(function(){e.autorized=!1,e.toggleLoad(!0),e.showContent()}))}},{key:"getApiKey",value:function(){var e=this;chrome.storage.local.get("api_key",(function(t){e.api_key=t.api_key,e.fetchStatus()}))}},{key:"showContent",value:function(){this.ui().workBlock.toggleClass("hidden",!this.autorized),this.ui().loginForm.toggleClass("hidden",this.autorized)}},{key:"fetchTabData",value:function(){var e=this;chrome.tabs.getSelected((function(t){e.setTabData(t)}))}},{key:"setTabData",value:function(e){var t=this;chrome.storage.local.set({image:this.base64,url:e.url,title:e.title},(function(){t.openNewTab()}))}},{key:"openNewTab",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"editor",t=window.open("chrome-extension://".concat(i.id,"/").concat(e,".html?blank"),"_blank");t.focus()}},{key:"toggleLoad",value:function(e){this.ui().loader.toggleClass("hidden",e)}}])&&o(t.prototype,n),a&&o(t,a),e}());$((function(){i.getApiKey(),i.ui().sendBtn.on("click",(function(e){e.preventDefault();var t=i.ui().loginForm.serializeArray();i.toggleLoad(!1),r.login(t).then((function(e){chrome.storage.local.set({api_key:e}),i.api_key=e,i.autorized=!0,i.toggleLoad(!0),i.showContent(),i.ui().error.addClass("hidden")}),(function(e){i.toggleLoad(!0),i.ui().error.removeClass("hidden").html("error")}))})),i.ui().screenBtn.on("click",(function(){chrome.tabs.captureVisibleTab(null,{},(function(e){i.base64=e,i.fetchTabData()}))})),i.ui().tasksBtn.on("click",(function(){i.openNewTab("tasks")}))}))}]);
//# sourceMappingURL=popup.js.map