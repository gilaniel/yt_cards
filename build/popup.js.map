{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/popup/index.js","webpack:///./src/services/index.js"],"names":["Popup","id","chrome","app","getDetails","autorized","apiKey","screenBtn","$","loginForm","sendBtn","error","loader","status","key","then","setTimeout","toggleLoad","showContent","storage","local","get","result","fetchStatus","ui","toggleClass","tabs","getSelected","data","setTabData","set","base64","url","title","openNewTab","win","window","open","popup","focus","state","getApiKey","on","e","preventDefault","serializeArray","login","payload","addClass","removeClass","html","captureVisibleTab","fetchTabData","post","addIssue","options","FormData","i","append","ajax","type","contentType","processData"],"mappings":"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","file":"popup.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/popup/index.js\");\n","import {login, status} from '../services/index';\n\nclass Popup {\n  constructor() {\n    this.id = chrome.app.getDetails().id;\n    this.autorized = false;\n    this.apiKey = false;\n  }\n\n  ui() {\n    return {\n      screenBtn: $('.js-make-screen-btn'),\n      loginForm: $('.login-form'),\n      sendBtn: $('.js-send-btn'),\n      error: $('.error'),\n      loader: $('.loader')\n    }\n  }\n\n  fetchStatus() {\n    status({ key: this.apiKey })\n      .then(() => {\n        this.autorized = true;\n\n        setTimeout(() => {\n          this.toggleLoad(true);\n          this.showContent();\n        },500);\n      }, () => {\n        this.autorized = false;\n\n        this.toggleLoad(true);\n        this.showContent();\n      });\n  }\n\n  getApiKey() {\n    chrome.storage.local.get('apiKey', (result) => {\n      this.apiKey = result.apiKey;\n\n      this.fetchStatus();\n    });\n  }\n\n  showContent() {\n    this.ui().screenBtn.toggleClass('hidden', !this.autorized);\n    this.ui().loginForm.toggleClass('hidden', this.autorized);\n  }\n\n  fetchTabData() {\n    chrome.tabs.getSelected((data) => {\n      this.setTabData(data)\n    })\n  }\n\n  setTabData(data) {\n    chrome.storage.local.set({\n      'image': this.base64,\n      'url': data.url,\n      'title': data.title\n    }, () => {\n      this.openNewTab();\n    });  \n  }\n\n  openNewTab() {\n    const win = window.open(`chrome-extension://${popup.id}/editor.html?blank`, '_blank');\n    win.focus();\n  }\n\n  toggleLoad(state) {\n    this.ui().loader.toggleClass('hidden', state);\n  }\n}\n\nconst popup = new Popup();\n\n$(() => {\n  popup.getApiKey();\n\n  popup.ui().sendBtn.on('click', (e) => {\n    e.preventDefault();\n\n    const data = popup.ui().loginForm.serializeArray();\n\n    popup.toggleLoad(false);\n\n    login(data).then((payload) => {\n      chrome.storage.local.set({ 'apiKey': payload });\n\n      popup.apiKey = payload;\n      popup.autorized = true;\n\n      popup.toggleLoad(true);\n      popup.showContent();\n\n      popup.ui().error.addClass('hidden');\n    }, (error) => {\n      popup.toggleLoad(true);\n      popup.ui().error.removeClass('hidden').html('error');\n    });\n  });\n\n  popup.ui().screenBtn.on('click', () => {\n    chrome.tabs.captureVisibleTab(null, {}, function (base64) {\n      popup.base64 = base64;\n  \n      popup.fetchTabData();\n    });\n  });\n});\n","export function login(data) {\n  return $.post('http://127.0.0.1:8010/login', data);\n}\n\nexport function addIssue(options) {\n  var data = new FormData();\n  \n  for(var i in options) {\n    data.append(i,options[i]);\n  }\n\n  return $.ajax({\n    type: 'POST',\n    url: 'http://127.0.0.1:8010/add_issue',\n    data: data,\n    contentType: false,\n    processData: false\n  });\n}\n\nexport function status(data) {\n  return $.post('http://127.0.0.1:8010/status', data);\n}"],"sourceRoot":""}